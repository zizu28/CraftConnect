@page "/admin/disputes"
@layout AdminLayout
@using CraftConnect.WebUI.Components.AdminPagesComponents.UserManagementPageComponent
@using CraftConnect.WebUI.Components.Layout.AdminPageLayouts

<div class="dispute-categories-container">
    <!-- Page Header -->
    <header class="page-header">
        <h1>Dispute Category Management</h1>
        <button class="btn btn-primary">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor"><path d="M10.75 4.75a.75.75 0 00-1.5 0v4.5h-4.5a.75.75 0 000 1.5h4.5v4.5a.75.75 0 001.5 0v-4.5h4.5a.75.75 0 000-1.5h-4.5v-4.5z" /></svg>
            Add New Category
        </button>
    </header>
    <p class="page-description">
        Define and organize the types of disputes that can arise on the platform.
    </p>

    <!-- Search Bar -->
    <div class="search-bar-container">
        <div class="search-container">
            <svg class="search-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M9 3.5a5.5 5.5 0 100 11 5.5 5.5 0 000-11zM2 9a7 7 0 1112.452 4.391l3.328 3.329a.75.75 0 11-1.06 1.06l-3.329-3.328A7 7 0 012 9z" clip-rule="evenodd" /></svg>
            <input type="text" class="search-input" placeholder="Search for categories" @bind="searchTerm" />
        </div>
    </div>

    <!-- Table Container -->
    <div class="table-container">
        <table class="categories-table">
            <thead>
                <tr>
                    <th>Category Name</th>
                    <th>Description</th>
                    <th>Last Updated</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody>
                @foreach (var category in filteredCategories)
                {
                    <tr>
                        <td class="cell-name">@category.CategoryName</td>
                        <td class="cell-description">@category.Description</td>
                        <td>@category.LastUpdated.ToString("yyyy-MM-dd")</td>
                        <td>
                            <div class="action-buttons">
                                <button class="btn-icon btn-edit">
                                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor"><path d="M5.433 13.917l1.262-3.155A4 4 0 017.58 9.42l6.92-6.918a2.121 2.121 0 013 3l-6.92 6.918c-.383.383-.84.685-1.343.886l-3.154 1.262a.5.5 0 01-.65-.65z" /><path d="M3.5 5.75c0-.69.56-1.25 1.25-1.25H10A.75.75 0 0110 6H4.75A.75.75 0 004 6.75v10.5c0 .414.336.75.75.75h10.5a.75.75 0 00.75-.75V10A.75.75 0 0118 10v7.25c0 .69-.56 1.25-1.25 1.25H4.75A1.25 1.25 0 013.5 17.25V5.75z" /></svg>
                                </button>
                                <button class="btn-icon btn-delete">
                                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M8.75 1A2.75 2.75 0 006 3.75v.443c-.795.077-1.584.176-2.365.298a.75.75 0 10.23 1.482l.149-.022.841 10.518A2.75 2.75 0 007.566 19h4.868a2.75 2.75 0 002.74-2.73l.841-10.52.149.023a.75.75 0 00.23-1.482A41.03 41.03 0 0014 4.193V3.75A2.75 2.75 0 0011.25 1H8.75zM10 4.193V3.75c0-.414.336-.75.75-.75h.5c.414 0 .75.336.75.75v.443a28.9 28.9 0 01-2 0zM7.566 17.5l-.838-10.474.062-.008.002.002a.75.75 0 01.73 1.483L7.566 17.5zM12.434 17.5l.838-10.474-.062-.008a.75.75 0 00-.73 1.482l.002.002.062.008L12.434 17.5z" clip-rule="evenodd" /></svg>
                                </button>
                            </div>
                        </td>
                    </tr>
                }
            </tbody>
        </table>
    </div>

    <!-- Pagination -->
    <div class="table-footer">
        <AdminPagination CurrentPage="currentPage" TotalPages="@TotalPages" OnPageChanged="OnPageSelected" />
    </div>
</div>

@code {
    private string searchTerm = "";
    private List<AdminDisputeCategory> categories = new();
    private List<AdminDisputeCategory> filteredCategories
    {
        get
        {
            var items = categories.AsEnumerable();
            items = items.Where(i => i.CategoryName.Contains(searchTerm, StringComparison.OrdinalIgnoreCase));
            return items.ToList();
        }
    }
    private int currentPage = 1;
    private int TotalPages;
    protected override void OnInitialized()
    {
        // Mock data from the image
        categories = new List<AdminDisputeCategory>
        {
            new AdminDisputeCategory 
            { 
                Id = Guid.NewGuid(), 
                CategoryName = "Payment Issue", 
                Description = "Disputes related to payments, invoices, or financial transactions.", 
                LastUpdated = new DateTime(2023, 10, 27) 
            },
            new AdminDisputeCategory 
            { 
                Id = Guid.NewGuid(),
                CategoryName = "Quality of Work", 
                Description = "Issues concerning the quality of the completed craftsmanship.", 
                LastUpdated = new DateTime(2023, 10, 26) 
            },
            new AdminDisputeCategory 
            { 
                Id = Guid.NewGuid(),
                CategoryName = "Project Scope", 
                Description = "Conflicts arising from disagreements about the project's scope or requirements.", 
                LastUpdated = new DateTime(2023, 10, 25) 
            }
        };
        TotalPages = categories.Count() / 5;
    }

    private void OnPageSelected(int page)
    {
        currentPage = page;
        // Add logic here to fetch data for the new page
    }
}