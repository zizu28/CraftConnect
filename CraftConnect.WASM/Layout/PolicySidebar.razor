@using CraftConnect.WASM.ViewModels
<aside class="policy-sidebar">
    <nav class="sticky-nav">
        <ul>
            @foreach (var item in NavItems)
            {
                <li>
                    <!-- 
                      STEP 2: Use the new IsActive logic
                    -->
                    <a href="@item.Href" class="nav-item @(IsActive(item.Href) ? "active" : "")">
                        <i class="nav-icon @item.IconClass"></i>
                        <span>@item.Title</span>
                    </a>
                </li>
            }
        </ul>
    </nav
</aside>

@code {
    <!-- 
      STEP 1: Add a parameter to receive the active ID from the layout
    -->
    [Parameter]
    public string ActiveSectionId { get; set; } = "introduction";

    private List<PolicyNavItem> NavItems = new();
    
    // All the NavigationManager and OnLocationChanged code can be removed.

    protected override void OnInitialized()
    {
        // This list of nav items remains the same
        NavItems = new List<PolicyNavItem>
        {
            new PolicyNavItem { Title = "Introduction", Href = "#introduction", IconClass = "bi bi-info-circle-fill" },
            new PolicyNavItem { Title = "Information We Collect", Href = "#information-we-collect", IconClass = "bi bi-database-fill" },
            new PolicyNavItem { Title = "How We Use Your Info", Href = "#how-we-use-your-information", IconClass = "bi bi-gear-fill" },
            new PolicyNavItem { Title = "Data Sharing and...", Href = "#data-sharing-and-disclosure", IconClass = "bi bi-share-fill" },
            new PolicyNavItem { Title = "Data Security", Href = "#data-security", IconClass = "bi bi-shield-lock-fill" },
            new PolicyNavItem { Title = "User Rights and Choices", Href = "#user-rights-and-choices", IconClass = "bi bi-person-check-fill" },
            new PolicyNavItem { Title = "Cookies and Tracking", Href = "#cookies-and-tracking", IconClass = "bi bi-cookie" },
            new PolicyNavItem { Title = "Changes to This Policy", Href = "#changes-to-this-policy", IconClass = "bi bi-clock-history" },
            new PolicyNavItem { Title = "Contact Information", Href = "#contact-information", IconClass = "bi bi-envelope-fill" }
        };
    }

    // STEP 3: Update the IsActive method
    private bool IsActive(string href)
    {
        // Compare the item's href (e.g., "#introduction") 
        // with the ActiveSectionId (e.g., "introduction")
        return href == "#" + ActiveSectionId;
    }
}