@page "/admin/disputes"
@layout AdminLayout
@using CraftConnect.WASM.Layout.AdminPageLayouts
@using CraftConnect.WASM.Components.AdminPagesComponents.UserManagementPageComponent
@using CraftConnect.WASM.ViewModels

<div class="dispute-categories-container">
    <!-- Page Header -->
    <header class="page-header">
        <h1>Dispute Category Management</h1>
        <button class="btn btn-primary">
            <i class="bi bi-plus-lg"></i>
            Add New Category
        </button>
    </header>
    <p class="page-description">
        Define and organize the types of disputes that can arise on the platform.
    </p>

    <!-- Search Bar -->
    <div class="search-bar-container">
        <div class="search-container">
            <i class="search-icon bi bi-search"></i>
            <input type="text" class="search-input" placeholder="Search for categories" @bind="searchTerm" />
        </div>
    </div>

    <!-- Table Container -->
    <div class="table-container">
        <table class="categories-table">
            <thead>
                <tr>
                    <th>Category Name</th>
                    <th>Description</th>
                    <th>Last Updated</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody>
                @foreach (var category in filteredCategories)
                {
                    <tr>
                        <td class="cell-name">@category.CategoryName</td>
                        <td class="cell-description">@category.Description</td>
                        <td>@category.LastUpdated.ToString("yyyy-MM-dd")</td>
                        <td>
                            <div class="action-buttons">
                                <button class="btn-icon btn-edit">
                                    <i class="bi bi-pencil"></i>
                                </button>
                                <button class="btn-icon btn-delete">
                                    <i class="bi bi-trash"></i>
                                </button>
                            </div>
                        </td>
                    </tr>
                }
            </tbody>
        </table>
    </div>

    <!-- Pagination -->
    <div class="table-footer">
        <AdminPagination CurrentPage="currentPage" TotalPages="@TotalPages" OnPageChanged="OnPageSelected" />
    </div>
</div>

@code {
    private string searchTerm = "";
    private List<AdminDisputeCategory> categories = new();
    private List<AdminDisputeCategory> filteredCategories
    {
        get
        {
            var items = categories.AsEnumerable();
            items = items.Where(i => i.CategoryName.Contains(searchTerm, StringComparison.OrdinalIgnoreCase));
            return items.ToList();
        }
    }
    private int currentPage = 1;
    private int TotalPages;
    protected override void OnInitialized()
    {
        // Mock data from the image
        categories = new List<AdminDisputeCategory>
        {
            new AdminDisputeCategory 
            { 
                Id = Guid.NewGuid(), 
                CategoryName = "Payment Issue", 
                Description = "Disputes related to payments, invoices, or financial transactions.", 
                LastUpdated = new DateTime(2023, 10, 27) 
            },
            new AdminDisputeCategory 
            { 
                Id = Guid.NewGuid(),
                CategoryName = "Quality of Work", 
                Description = "Issues concerning the quality of the completed craftsmanship.", 
                LastUpdated = new DateTime(2023, 10, 26) 
            },
            new AdminDisputeCategory 
            { 
                Id = Guid.NewGuid(),
                CategoryName = "Project Scope", 
                Description = "Conflicts arising from disagreements about the project's scope or requirements.", 
                LastUpdated = new DateTime(2023, 10, 25) 
            }
        };
        TotalPages = categories.Count() / 5;
    }

    private void OnPageSelected(int page)
    {
        currentPage = page;
        // Add logic here to fetch data for the new page
    }
}